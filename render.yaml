services:
  # Backend API Service (IMPORTANT: Actual service is lobaiseo-backend-yjnl)
  # This render.yaml may not be in use - backend deployed separately
  - type: web
    name: lobaiseo-backend-yjnl
    runtime: node
    region: singapore
    buildCommand: cd server && npm install
    startCommand: cd server && node server.js
    envVars:
      - key: NODE_ENV
        value: production
      - key: RUN_MODE
        value: AZURE
      - key: PORT
        generateValue: true
      - key: FRONTEND_URL
        value: https://www.app.lobaiseo.com
      - key: GOOGLE_CLIENT_ID
        sync: false
      - key: GOOGLE_CLIENT_SECRET
        sync: false
      - key: GOOGLE_REDIRECT_URI
        value: https://www.app.lobaiseo.com/auth/google/callback
      - key: HARDCODED_ACCOUNT_ID
        value: 102242055729678854724
      - key: RAZORPAY_KEY_ID
        sync: false
      - key: RAZORPAY_KEY_SECRET
        sync: false
      - key: RAZORPAY_WEBHOOK_SECRET
        value: gmb_boost_pro_webhook_secret_2024
      - key: OPENAI_API_KEY
        sync: false
      - key: OPENAI_MODEL
        value: gpt-4o-mini
      - key: OPENAI_ENDPOINT
        value: https://api.openai.com/v1/chat/completions
      - key: FIREBASE_PROJECT_ID
        value: gbp-467810-a56e2

  # Frontend Static Site
  - type: web
    name: lobaiseofrontend
    env: static
    buildCommand: npm install && npm run build
    staticPublishPath: dist
    pullRequestPreviewsEnabled: true
    envVars:
      - key: VITE_BACKEND_URL
        value: https://lobaiseo-backend-yjnl.onrender.com
      - key: VITE_OPENAI_API_KEY
        sync: false
      - key: VITE_OPENAI_MODEL
        value: gpt-4o-mini
      - key: VITE_OPENAI_ENDPOINT
        value: https://api.openai.com/v1/chat/completions
    routes:
      - type: rewrite
        source: /*
        destination: /index.html
    headers:
      - path: /*
        name: Cache-Control
        value: public, max-age=0, must-revalidate
      - path: /index.html
        name: Cache-Control
        value: no-cache
